<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Matthew Hlina - Logistic Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Matthew Hlina</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-academic-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Academic Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-academic-projects">    
        <li>
    <a class="dropdown-item" href="../../projects/fertility/index.html" rel="" target="">
 <span class="dropdown-text">Polynomial Effects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../projects/wine/index.html" rel="" target="">
 <span class="dropdown-text">Logrithmic Transformations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../projects/same-sex-marriage/index.html" rel="" target="">
 <span class="dropdown-text">Logistic Regression</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../projects/nhl/index.html" rel="" target="">
 <span class="dropdown-text">Unconditional Longitudinal Mixed-Effects Models</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../research/index.html" rel="" target="">
 <span class="menu-text">Research Experience</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about/index.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/matthew-hlina-1aa167275" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://scholar.google.com/citations?user=q6zxiHYAAAAJ&amp;hl=en&amp;oi=ao" rel="" target=""><i class="bi bi-mortarboard" role="img" aria-label="google scholar">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/matthewhlina" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:hlina002@umn.edu" rel="" target=""><i class="bi bi-envelope" role="img" aria-label="email">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-effect-of-religion-on-personal-support-for-same-sex-marriage" id="toc-the-effect-of-religion-on-personal-support-for-same-sex-marriage" class="nav-link active" data-scroll-target="#the-effect-of-religion-on-personal-support-for-same-sex-marriage">The Effect of Religion on Personal Support for Same-Sex Marriage</a>
  <ul class="collapse">
  <li><a href="#examining-the-relationships" id="toc-examining-the-relationships" class="nav-link" data-scroll-target="#examining-the-relationships">Examining the Relationships</a></li>
  <li><a href="#creating-and-comparing-models" id="toc-creating-and-comparing-models" class="nav-link" data-scroll-target="#creating-and-comparing-models">Creating and Comparing Models</a></li>
  <li><a href="#interpretting-model-5" id="toc-interpretting-model-5" class="nav-link" data-scroll-target="#interpretting-model-5">Interpretting Model 5</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Logistic Regression</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="the-effect-of-religion-on-personal-support-for-same-sex-marriage" class="level2">
<h2 class="anchored" data-anchor-id="the-effect-of-religion-on-personal-support-for-same-sex-marriage">The Effect of Religion on Personal Support for Same-Sex Marriage</h2>
<p><a href="https://raw.githubusercontent.com/zief0002/bespectacled-antelope/main/data/same-sex-marriage.csv">CSV</a></p>
<p><a href="http://zief0002.github.io/bespectacled-antelope/codebooks/same-sex-marriage.html">Codebook</a></p>
<section id="examining-the-relationships" class="level3">
<h3 class="anchored" data-anchor-id="examining-the-relationships">Examining the Relationships</h3>
<p>Religious service attendance and type of denomination are thought to be associated with support for or against same-sex marriage. 1746 participants were recruited to take a survey that asked for their denomination, service attendance frequency, and support for or against same-sex marriage (0 = no; 1 = yes). A Likert-scale was used to quantify the service attendance frequency predictor (0 = never; 4 = every week), making it necessary to determine whether this predictor should be treated as continuous or categorical before any regressing can be done. The below figure shows the relationship between support and attendance. Responses are dispersed above and below 0 and 1 on the y-axis to demonstrate that numerous data points were used to create the figure, although all these data points fall on either 0 or 1.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-scatter" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-scatter-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Scatterplot with smoother showing the relationship between religious service attendance and support for same-sex marriage where support for same-sex marriage is 1 and support against same-sex marriage is 0.</figcaption>
</figure>
</div>
</div>
</div>
<p>The relationship between proportion of support and attendance appears to be linear, meaning the Likert-scale data can be treated as if it were continuous.</p>
</section>
<section id="creating-and-comparing-models" class="level3">
<h3 class="anchored" data-anchor-id="creating-and-comparing-models">Creating and Comparing Models</h3>
<p>Five models were created and compared to determine which most appropriately represents the data. The table below shows these models.</p>

<table class="texreg" style="margin: 10px auto;border-collapse: collapse;border-spacing: 0px;color: #000000;border-top: 1px solid #000000;">
<caption>
Table 1. Five candidate models predicting variation in the log-odds of supporting same-sex marriage. The denomination predictor was dummy coded (Catholic, Jewish, and Other), with Protestant as the reference group.
</caption>
<thead>
<tr>
<th style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 1
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 2
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 3
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 4
</th>
<th style="padding-left: 20px;padding-right: 20px;">
Model 5
</th>
</tr>
</thead>
<tbody>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 20px;padding-right: 20px;">
Attendance_L
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.14
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.14
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.04
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.03
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.12)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.13)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.13)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.13)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Attendance_Q
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.12
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.12
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.07
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.07
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.03)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.03)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.03)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.03)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Catholic
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.77
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.66
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.50
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.50
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.14)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.14)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.15)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.15)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Jewish
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.38
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.25
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.07
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.06
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.13)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.13)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.14)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.14)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Other
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2.30
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.93
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.76
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1.76
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.52)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.53)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.55)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.55)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Age
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.02
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.03
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.00)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.00)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Friends
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.76
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.73
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.11)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.11)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Female
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.33
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.11)
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
Intercept
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.19
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-1.07
</td>
<td style="padding-left: 20px;padding-right: 20px;">
-0.53
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.36
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.22
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
&nbsp;
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.10)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.10)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.14)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.24)
</td>
<td style="padding-left: 20px;padding-right: 20px;">
(0.25)
</td>
</tr>
<tr style="border-top: 1px solid #000000;">
<td style="padding-left: 20px;padding-right: 20px;">
Deviance
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2120.45
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2188.60
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2085.59
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1967.75
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1959.48
</td>
</tr>
<tr>
<td style="padding-left: 20px;padding-right: 20px;">
AICc
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2126.47
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2196.62
</td>
<td style="padding-left: 20px;padding-right: 20px;">
2085.59
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1967.75
</td>
<td style="padding-left: 20px;padding-right: 20px;">
1959.48
</td>
</tr>
<tr style="border-bottom: 1px solid #000000;">
<td style="padding-left: 20px;padding-right: 20px;">
R2
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.05
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.02
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.07
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.12
</td>
<td style="padding-left: 20px;padding-right: 20px;">
0.12
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="font-size: 0.8em;" colspan="6">
The <span class="math inline">\(R^2\)</span> value is based on the proportion of reduced deviance from the intercept-only model.
</td>
</tr>
</tfoot>

</table>
<p>Model 5 was the most appropriate model for the data. Here is its equation.</p>
<p><span class="math display">\[
\begin{align}
\mathrm{Model~5}: \mathrm{ln(\frac{\hat{\pi_i}}{1+\hat{\pi_i}})} &amp;= 0.22 - 0.03(\mathrm{Attendance}_i) - 0.07(\mathrm{Attendance}_i^2) + 0.50(\mathrm{Catholic}_i)
\nonumber \\
&amp;\quad + 0.06(\mathrm{Jewish}_i) + 1.76(\mathrm{Other}_i) - 0.03(\mathrm{Age}_i) + 0.73(\mathrm{Friends}_i) + 0.33(\mathrm{Female}_i)
\end{align}
\]</span></p>
</section>
<section id="interpretting-model-5" class="level3">
<h3 class="anchored" data-anchor-id="interpretting-model-5">Interpretting Model 5</h3>
<p>To understand the odds associated with Model 5, the equation for the model was back transformed by exponentiating.</p>
<p><span class="math display">\[
\begin{align}
\mathrm{Model~5}: \mathrm{(\frac{\hat{\pi_i}}{1+\hat{\pi_i}})} &amp;= e^{0.22 - 0.03(\mathrm{Attendance}_i) - 0.07(\mathrm{Attendance}_i^2) + 0.50(\mathrm{Catholic}_i)}
\nonumber \\
&amp;\quad ^{+ 0.06(\mathrm{Jewish}_i) + 1.76(\mathrm{Other}_i) - 0.03(\mathrm{Age}_i) + 0.73(\mathrm{Friends}_i) + 0.33(\mathrm{Female}_i)}
\end{align}
\]</span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept)      attendance I(attendance^2)        catholic           other 
      1.2482337       0.9656859       0.9318691       1.6521952       1.0568366 
         jewish             age         friends          female 
      5.7863631       0.9749867       2.0735231       1.3847902 </code></pre>
</div>
</div>
<p>The predicted odds of supporting same-sex marriage are 1.2 for a male protestant at age 0, which in practical terms is not interpretable because a newborn child will not be for or against same-sex marriage. To make a better conclusion, the average age of a male in this study (47.7) was substituted in for age and the equation was then solved. The results showed that a 47.7 year old protest man who does not have any LGBTQ+ friends or family members and never attends religious services has a probability of supporting same-sex marriage of 0.37, meaning the probability of supporting same-sex marriage is 2.7 times less likely than not supporting for individuals with those characteristics.</p>
<p>All other religious denominations in this study are more likely to support same-sex marriage than protestants (Catholic = 1.6 times more likely; Jewish = 5.9 times more likely; Other = 1.1 times more likely). People who have friends or family members that are LGBTQ+ are 2.1 times more likely to support same-sex marriage than those who do not, and women are 1.4 times as likely to support same-sex marriage as men are. Attending religious service is associated with a decreased probability of supporting same-sex marriage, and this effect of religious service attendance becomes stronger as attendance frequency increases (i.e., the more frequent a person attends religious services, the less likely they support same-sex marriage).</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5922417</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-fits" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-fits-1.png" class="img-fluid figure-img" width="1152"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Generalized linear models showing the relationship between religious service attendance and support for same-sex marriage, for male respondents of mean age (47.7 in the dataset) who do not have LGBTQ+ friends.</figcaption>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("https:\/\/github\.com\/matthewhlina\/website");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb3" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Logistic Regression"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 12</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 9</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: false</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Effect of Religion on Personal Support for Same-Sex Marriage</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">CSV</span><span class="co">](https://raw.githubusercontent.com/zief0002/bespectacled-antelope/main/data/same-sex-marriage.csv)</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Codebook</span><span class="co">](http://zief0002.github.io/bespectacled-antelope/codebooks/same-sex-marriage.html)</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="fu">### Examining the Relationships</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>Religious service attendance and type of denomination are thought to be associated with support for or against same-sex marriage. 1746 participants were recruited to take a survey that asked for their denomination, service attendance frequency, and support for or against same-sex marriage (0 = no; 1 = yes). A Likert-scale was used to quantify the service attendance frequency predictor (0 = never; 4 = every week), making it necessary to determine whether this predictor should be treated as continuous or categorical before any regressing can be done. The below figure shows the relationship between support and attendance. Responses are dispersed above and below 0 and 1 on the y-axis to demonstrate that numerous data points were used to create the figure, although all these data points fall on either 0 or 1.</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-scatter</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Scatterplot with smoother showing the relationship between religious service attendance and support for same-sex marriage where support for same-sex marriage is 1 and support against same-sex marriage is 0."</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="co">#library(AICcmodavg)</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="co">#library(educate) </span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtext)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(texreg)</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>ssm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"same-sex-marriage.csv"</span>) </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>ssm_prop <span class="ot">&lt;-</span> ssm <span class="sc">|&gt;</span> </span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(attendance, support) <span class="sc">|&gt;</span> </span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop =</span> N <span class="sc">/</span> <span class="fu">sum</span> (N)</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>ssm_prop_2 <span class="ot">&lt;-</span> ssm <span class="sc">|&gt;</span> </span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(denomination, support,) <span class="sc">|&gt;</span> </span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">N =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">Prop =</span> N <span class="sc">/</span> <span class="fu">sum</span> (N)</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ssm, <span class="fu">aes</span>(<span class="at">x =</span> attendance, <span class="at">y =</span> <span class="fu">jitter</span>(support))) <span class="sc">+</span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'loess'</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span>  <span class="fu">element_markdown</span>(),</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span>  <span class="fu">element_markdown</span>(),</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Religious Service Attendance"</span>) <span class="sc">+</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Support for Same-Sex Marriage"</span>,</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="dv">1</span>)</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>The relationship between proportion of support and attendance appears to be linear, meaning the Likert-scale data can be treated as if it were continuous.</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a><span class="fu">### Creating and Comparing Models</span></span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>Five models were created and compared to determine which most appropriately represents the data. The table below shows these models.</span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>glm<span class="fl">.1</span>_quad <span class="ot">&lt;-</span> <span class="fu">glm</span>(support <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attendance <span class="sc">+</span> <span class="fu">I</span>(attendance<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> ssm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>                 )</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>ssm <span class="ot">&lt;-</span> ssm <span class="sc">|&gt;</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">catholic =</span> <span class="fu">if_else</span>(denomination <span class="sc">==</span> <span class="st">"Catholic"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">jewish =</span> <span class="fu">if_else</span>(denomination <span class="sc">==</span> <span class="st">"Jewish"</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">other =</span> <span class="fu">if_else</span>(denomination <span class="sc">==</span> <span class="st">"Other"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>glm<span class="fl">.1</span>_jewish <span class="ot">&lt;-</span> <span class="fu">glm</span>(support <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> catholic <span class="sc">+</span> other <span class="sc">+</span> jewish, <span class="at">data =</span> ssm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>glm<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(support <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attendance <span class="sc">+</span> <span class="fu">I</span>(attendance<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> catholic <span class="sc">+</span> other <span class="sc">+</span> jewish, <span class="at">data =</span> ssm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>glm<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(support <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attendance <span class="sc">+</span> <span class="fu">I</span>(attendance<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> catholic <span class="sc">+</span> other <span class="sc">+</span> jewish <span class="sc">+</span> age <span class="sc">+</span> friends, <span class="at">data =</span> ssm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a>glm<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(support <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> attendance <span class="sc">+</span> <span class="fu">I</span>(attendance<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> catholic <span class="sc">+</span> other <span class="sc">+</span> jewish <span class="sc">+</span> age <span class="sc">+</span> friends <span class="sc">+</span> female, <span class="at">data =</span> ssm, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a><span class="co">#aictab(</span></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a> <span class="co"># cand.set = list(glm.1_quad,  glm.3, glm.5, glm.6),</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a><span class="co">#  modnames = c("Attendance_Q", "Attendance_Q &amp; Denomination", "Age &amp; Friends", "Age, Friends, &amp; Female")</span></span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a><span class="co">#)</span></span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a><span class="do">### Presenting a Table of Logistic Regression Results</span></span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a><span class="fu">htmlreg</span>(</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">l =</span> <span class="fu">list</span>(glm<span class="fl">.1</span>_quad, glm<span class="fl">.1</span>_jewish, glm<span class="fl">.3</span>, glm<span class="fl">.5</span>, glm<span class="fl">.6</span>),</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">stars =</span> <span class="fu">numeric</span>(<span class="dv">0</span>),    <span class="co">#No p-value stars</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">padding =</span> <span class="dv">20</span>,          <span class="co">#Add space around columns (you may need to adjust this via trial-and-error)</span></span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.model.names =</span> <span class="fu">c</span>(<span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span>, <span class="st">"Model 5"</span>), </span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.coef.names =</span> <span class="fu">c</span>(<span class="st">"Intercept"</span>, <span class="st">"Attendance_L"</span>, <span class="st">"Attendance_Q"</span>, </span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Catholic"</span>, <span class="st">"Jewish"</span>, <span class="st">"Other"</span>, </span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Age"</span>, <span class="st">"Friends"</span>, <span class="st">"Female"</span>),</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.coef =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>, <span class="dv">1</span>), <span class="co">#Put intercept at bottom of table</span></span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.aic =</span> <span class="cn">FALSE</span>, <span class="co">#Omit AIC</span></span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.bic =</span> <span class="cn">FALSE</span>, <span class="co">#Omit BIC</span></span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.nobs =</span> <span class="cn">FALSE</span>,  <span class="co">#Omit sample size</span></span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">include.loglik =</span> <span class="cn">FALSE</span>,   <span class="co">#Omit log-likelihood</span></span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.gof.rows =</span> <span class="fu">list</span>(</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">AICc =</span> <span class="fu">c</span>(<span class="fl">2126.47</span>, <span class="fl">2196.62</span>, <span class="fl">2085.59</span>, <span class="fl">1967.75</span>, <span class="fl">1959.48</span>),</span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">R2 =</span> (<span class="fl">2238.973</span> <span class="sc">-</span> <span class="fu">c</span>(<span class="fl">2120.452</span>, <span class="fl">2188.596</span>, <span class="fl">2085.592</span>, <span class="fl">1967.755</span>, <span class="fl">1959.48</span>)) <span class="sc">/</span> <span class="fl">2238.973</span>),</span>
<span id="cb3-138"><a href="#cb3-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">reorder.gof =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb3-139"><a href="#cb3-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Table 1. Five candidate models predicting variation in the log-odds of supporting same-sex marriage. The denomination predictor was dummy coded (Catholic, Jewish, and Other), with Protestant as the reference group."</span>,</span>
<span id="cb3-140"><a href="#cb3-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption.above =</span> <span class="cn">TRUE</span>, <span class="co">#Move caption above table</span></span>
<span id="cb3-141"><a href="#cb3-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">inner.rules =</span> <span class="dv">1</span>, <span class="co">#Include line rule before model-level output</span></span>
<span id="cb3-142"><a href="#cb3-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">outer.rules =</span> <span class="dv">1</span> , <span class="co">#Include line rules around table</span></span>
<span id="cb3-143"><a href="#cb3-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">custom.note =</span> <span class="st">"The $R^2$ value is based on the proportion of reduced deviance from the intercept-only model."</span></span>
<span id="cb3-144"><a href="#cb3-144" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-145"><a href="#cb3-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-146"><a href="#cb3-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-147"><a href="#cb3-147" aria-hidden="true" tabindex="-1"></a>Model 5 was the most appropriate model for the data. Here is its equation.</span>
<span id="cb3-148"><a href="#cb3-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-149"><a href="#cb3-149" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-150"><a href="#cb3-150" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb3-151"><a href="#cb3-151" aria-hidden="true" tabindex="-1"></a>\mathrm{Model~5}: \mathrm{ln(\frac{\hat{\pi_i}}{1+\hat{\pi_i}})} &amp;= 0.22 - 0.03(\mathrm{Attendance}_i) - 0.07(\mathrm{Attendance}_i^2) + 0.50(\mathrm{Catholic}_i)</span>
<span id="cb3-152"><a href="#cb3-152" aria-hidden="true" tabindex="-1"></a>\nonumber <span class="sc">\\</span></span>
<span id="cb3-153"><a href="#cb3-153" aria-hidden="true" tabindex="-1"></a>&amp;\quad + 0.06(\mathrm{Jewish}_i) + 1.76(\mathrm{Other}_i) - 0.03(\mathrm{Age}_i) + 0.73(\mathrm{Friends}_i) + 0.33(\mathrm{Female}_i)</span>
<span id="cb3-154"><a href="#cb3-154" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb3-155"><a href="#cb3-155" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb3-156"><a href="#cb3-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-157"><a href="#cb3-157" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretting Model 5</span></span>
<span id="cb3-158"><a href="#cb3-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-159"><a href="#cb3-159" aria-hidden="true" tabindex="-1"></a>To understand the odds associated with Model 5, the equation for the model was back transformed by exponentiating.</span>
<span id="cb3-160"><a href="#cb3-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-161"><a href="#cb3-161" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb3-162"><a href="#cb3-162" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb3-163"><a href="#cb3-163" aria-hidden="true" tabindex="-1"></a>\mathrm{Model~5}: \mathrm{(\frac{\hat{\pi_i}}{1+\hat{\pi_i}})} &amp;= e^{0.22 - 0.03(\mathrm{Attendance}_i) - 0.07(\mathrm{Attendance}_i^2) + 0.50(\mathrm{Catholic}_i)}</span>
<span id="cb3-164"><a href="#cb3-164" aria-hidden="true" tabindex="-1"></a>\nonumber <span class="sc">\\</span></span>
<span id="cb3-165"><a href="#cb3-165" aria-hidden="true" tabindex="-1"></a>&amp;\quad ^{+ 0.06(\mathrm{Jewish}_i) + 1.76(\mathrm{Other}_i) - 0.03(\mathrm{Age}_i) + 0.73(\mathrm{Friends}_i) + 0.33(\mathrm{Female}_i)}</span>
<span id="cb3-166"><a href="#cb3-166" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb3-167"><a href="#cb3-167" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb3-168"><a href="#cb3-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-171"><a href="#cb3-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-172"><a href="#cb3-172" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(glm<span class="fl">.6</span>))</span>
<span id="cb3-173"><a href="#cb3-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-174"><a href="#cb3-174" aria-hidden="true" tabindex="-1"></a>The predicted odds of supporting same-sex marriage are 1.2 for a male protestant at age 0, which in practical terms is not interpretable because a newborn child will not be for or against same-sex marriage. To make a better conclusion, the average age of a male in this study (47.7) was substituted in for age and the equation was then solved. The results showed that a 47.7 year old protest man who does not have any LGBTQ+ friends or family members and never attends religious services has a probability of supporting same-sex marriage of 0.37, meaning the probability of supporting same-sex marriage is 2.7 times less likely than not supporting for individuals with those characteristics. </span>
<span id="cb3-175"><a href="#cb3-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-176"><a href="#cb3-176" aria-hidden="true" tabindex="-1"></a>All other religious denominations in this study are more likely to support same-sex marriage than protestants (Catholic = 1.6 times more likely; Jewish = 5.9 times more likely; Other = 1.1 times more likely). People who have friends or family members that are LGBTQ+ are 2.1 times more likely to support same-sex marriage than those who do not, and women are 1.4 times as likely to support same-sex marriage as men are. Attending religious service is associated with a decreased probability of supporting same-sex marriage, and this effect of religious service attendance becomes stronger as attendance frequency increases (i.e., the more frequent a person attends religious services, the less likely they support same-sex marriage).</span>
<span id="cb3-177"><a href="#cb3-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-180"><a href="#cb3-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-181"><a href="#cb3-181" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fl">0.3732402</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="fl">0.3732402</span>))</span>
<span id="cb3-182"><a href="#cb3-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-183"><a href="#cb3-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-184"><a href="#cb3-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-187"><a href="#cb3-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb3-188"><a href="#cb3-188" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb3-189"><a href="#cb3-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb3-190"><a href="#cb3-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb3-191"><a href="#cb3-191" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-fits</span></span>
<span id="cb3-192"><a href="#cb3-192" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Generalized linear models showing the relationship between religious service attendance and support for same-sex marriage, for male respondents of mean age (47.7 in the dataset) who do not have LGBTQ+ friends."</span></span>
<span id="cb3-193"><a href="#cb3-193" aria-hidden="true" tabindex="-1"></a><span class="co">#tidy(glm.6)</span></span>
<span id="cb3-194"><a href="#cb3-194" aria-hidden="true" tabindex="-1"></a>avg_age <span class="ot">&lt;-</span> ssm <span class="sc">|&gt;</span></span>
<span id="cb3-195"><a href="#cb3-195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(age))</span>
<span id="cb3-196"><a href="#cb3-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-197"><a href="#cb3-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the fitted equations: Probability of supporting same-sex marriage</span></span>
<span id="cb3-198"><a href="#cb3-198" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ssm, <span class="fu">aes</span>(<span class="at">x =</span> attendance, <span class="at">y =</span> support)) <span class="sc">+</span></span>
<span id="cb3-199"><a href="#cb3-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-200"><a href="#cb3-200" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Protestants</span></span>
<span id="cb3-201"><a href="#cb3-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_function</span>(</span>
<span id="cb3-202"><a href="#cb3-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>))},</span>
<span id="cb3-203"><a href="#cb3-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb3-204"><a href="#cb3-204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Protestant"</span>)</span>
<span id="cb3-205"><a href="#cb3-205" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> <span class="co"># -.02533145*age </span></span>
<span id="cb3-206"><a href="#cb3-206" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Catholics</span></span>
<span id="cb3-207"><a href="#cb3-207" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb3-208"><a href="#cb3-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>( (<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">+</span> <span class="fl">0.50210485</span> <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span><span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">+</span> <span class="fl">0.50210485</span> <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>))},</span>
<span id="cb3-209"><a href="#cb3-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb3-210"><a href="#cb3-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Catholic"</span>)</span>
<span id="cb3-211"><a href="#cb3-211" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-212"><a href="#cb3-212" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Jewish</span></span>
<span id="cb3-213"><a href="#cb3-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb3-214"><a href="#cb3-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">+</span> <span class="fl">1.75550397</span> <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">+</span> <span class="fl">1.75550397</span> <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>))},</span>
<span id="cb3-215"><a href="#cb3-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb3-216"><a href="#cb3-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Jewish"</span>)</span>
<span id="cb3-217"><a href="#cb3-217" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-218"><a href="#cb3-218" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Other</span></span>
<span id="cb3-219"><a href="#cb3-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_function</span>(</span>
<span id="cb3-220"><a href="#cb3-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">fun =</span> <span class="cf">function</span>(x) {<span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">+</span> <span class="fl">0.05528007</span> <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>((<span class="sc">-</span><span class="fl">0.02533145</span> <span class="sc">*</span> <span class="fl">47.65865</span>) <span class="sc">+</span> <span class="fl">0.05528007</span> <span class="sc">-</span> <span class="fl">0.22172950</span> <span class="sc">-</span> <span class="fl">0.03491663</span> <span class="sc">*</span> (x) <span class="sc">-</span> <span class="fl">0.07056294</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>))},</span>
<span id="cb3-221"><a href="#cb3-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb3-222"><a href="#cb3-222" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">color =</span> <span class="st">"Other"</span>)</span>
<span id="cb3-223"><a href="#cb3-223" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-224"><a href="#cb3-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb3-225"><a href="#cb3-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-226"><a href="#cb3-226" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-227"><a href="#cb3-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span>  <span class="fu">element_markdown</span>(),</span>
<span id="cb3-228"><a href="#cb3-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span>  <span class="fu">element_markdown</span>(),</span>
<span id="cb3-229"><a href="#cb3-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.75</span>)</span>
<span id="cb3-230"><a href="#cb3-230" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb3-231"><a href="#cb3-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">'Denomination'</span>,</span>
<span id="cb3-232"><a href="#cb3-232" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">'Protestant'</span>, <span class="st">'Catholic'</span>, <span class="st">'Jewish'</span>, <span class="st">'Other'</span>),</span>
<span id="cb3-233"><a href="#cb3-233" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">'Protestant'</span><span class="ot">=</span><span class="st">'red'</span>, <span class="st">'Catholic'</span><span class="ot">=</span><span class="st">'blue'</span>, <span class="st">'Jewish'</span><span class="ot">=</span><span class="st">'purple'</span>, <span class="st">'Other'</span> <span class="ot">=</span> <span class="st">'green'</span>)) <span class="sc">+</span></span>
<span id="cb3-234"><a href="#cb3-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Religious Service Attendance"</span>) <span class="sc">+</span></span>
<span id="cb3-235"><a href="#cb3-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Predicted Rrobability of Supporting Same-Sex Marriage"</span>) <span class="sc">+</span></span>
<span id="cb3-236"><a href="#cb3-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb3-237"><a href="#cb3-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb3-238"><a href="#cb3-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-239"><a href="#cb3-239" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>